# 2장 서버
**서버**란 사용자의 요청을 받고 응답을 반환하는 하드웨어를 말한다.

## 2.1 서버의 종류
- 랙 마운트형과 타워형 서버의 차이<br>
    **랙 마운트형 서버**는 데이터 센터나 서버 룸에 설치된 랙 안에 들어간다.<br>
    **타워형 서버**는 사내 서버 룸에 설치되거나 사무실 또는 점포 등에도 설치된다.<br>
    서버는 냉방과 소음을 고려해서 설치 장소를 골라야 한다.

- 엔트리<br>
    **가격** : 수백만원<br>
    **용도** : 주로 웹 서버나 애플리케이션 서버에서 이용<br>
    **CPU 탑재** : 소켓 단위로 1 ~ 2개의 CPU 탑재

- 미들레인지<br>
    **가격** : 수천만원<br>
    **용도** : 데이터베이스 서버나 기간계 서버에서 이용<br>
    **CPU 탑재** : 소켓 단위로 4개 이상의 CPU 탑재

- 하이엔드 서버<br>
    **가격** : 수억원<br>
    **용도** : 데이터베이스 서버나 기간계 서버에서 이용<br>
    **CPU 탑재** : 소켓 단위로 수십 개 이상의 CPU 탑재

- IA 서버<br>
    인텔이나 AMD 등 인텔 호환 CPU를 탑재하고 일반 컴퓨터와 같은 아키텍처를 기반으로 해 만들어진 서버를 말한다.

- 엔터프라이즈 서버<br>
    기간계에 사용되는 서버를 가리켜 '엔터프라이즈 서버'라고 부른다.

## 2.2 서버 선정
- 서버의 조건<br>
    CPU, 메모리, 디스크, NIC 포트 수, RAID 유무 등

- 서버 사양 결정 방법
    1) 실제 환경을 시험적으로 구축해 측정 결과를 보고 판단
        - 준비에 많은 노력과 시간이 필요
    2) 임시로 결정한 서버 사양의 기기를 현장에 투입해 실제 하드웨어 자원의 이용 상황을 측정한 다음, 서버와 서버의 부품을 늘리거나 줄인다.
        - 실제로 공개해보지 않아서 액세스 양이 판명되지 않을 때 좋은 방법
    3) 소거법으로 사용을 좁혀간다.
        - 어느 정도, 서비스의 성질이 정해져 있을 때 사용하는 방법

- 스케일 아웃과 스케일 업<br>
**스케일 아웃**은 성능이 부족해지면 서버의 수를 늘려서 수용량을 늘리는 방법<br>
**스케일 업**은 성능이 부족해지면 메모리 증설 등 부품을 추가/교환하거나 상위 기종으로 교체해 서버 성능을 높이는 방법

## 2.3 CPU
- 성능과 발열, 소비 전력<br>
멀티코어나 멀티스레드와 같은 방식을 이용해서 하나의 CPU로 동시에 처리할 수 있는 연산 개수를 늘려서 연산 능력의 향상을 기대한다.

- CPU 선정의 포인트
    1) 요구하는 연산 능력을 만족하는가? 
    2) 가격이 타당한가?
    3) 소프트웨어의 라이센스 체계를 잘 이해하고 가능한 싼 가격의 라이센스 체계를 골랐는가?
    4) 소비 전력을 절약하고 싶은가?

## 2.4 메모리
서버용 메모리에서는 용량 이외에도 내장애성, 성능, 저전력 등이 중시

- 성능
  - ex) 'DDR3-1600'인 경우 데이터 전송 속도 = 1600MHz * 8bytes  = 12.8GB/sec

- 메모리 용어
  - 슬롯 ( 메인보드에 있는 메모리 삽입구 )
  - ECC 메모리
    - 패리티 정보가 추가된 메모리
    - ECC 메모리를 사용했을 때 메모리 고장 발생 시 비트 반전 오류를 메모리가 스스로 잡는다.
  - 채널
    - CPU와 메인보드의 칩셋이 복수의 채널을 지원하면, 채널별로 같은 종류의 메모리를 탑재해 데이터 폭을 넓히고 성능을 높힐 수 있다.
    - 다중 채널을 실현할 때 각 프로세서의 메모리 구성은 동일해야 한다.
  - 랭크
    - 메모리 컨트롤러가 메모리의 DRAM에서 데이터를 입출력하는 단위
    - 서버에 메모리를 삽입할 때 랭크의 총 사용 수가 많아지게 조합하면 액세스 성능이 향상된다.
  - DIMM ( 여러 개의 DRAM 칩을 회로 기판 위에 탑재한 메모리 모듈 )
  - UDIMM
    - 버퍼 없는 DIMM(Dual In-line Memory Module)
    - 버퍼나 레지스터가 없어 빠른 액세스 가능
  - RDIMM
    - 레지스터 DIMM
    - 버퍼(레지스터)를 추가하여 DIMM의 주소와 명령 신호를 관리
    - 대용량 메모리나 안정적으로 운영이 필요한 서버용 메모리로 자주 사용
    - 중간에 버퍼 회로가 있어서 딜레이가 증가하므로 UDIMM보다 액세스 속도가 떨어진다.
  - LRDIMM
    - RDIMM에 버퍼를 추가하여 데이터 신호를 제어
    - 메모리 컨트롤러와 메모리 칩 사이의 모든 통신이 버퍼 회로를 매개로 이루어지는 DIMM
  - LV
    - 저전력을 실현한 메모리
    
- 메모리 삽입 방법 규칙
  - 각 프로세서의 메모리 구성은 같아야 한다.
  - RDIMM 메모리와 UDIMM 메모리는 섞어서 쓸 수 없다.
  - 각 채널에 탑재하는 메모리는 같은 종류로 할 필요가 있다.
  - 저전압 메모리와 저전압이 아닌 메모리는 섞어서 쓸 수 있을 때가 많다.
  - 원칙적으로 ECC 메모리와 비 ECC 메모리는 섞어서 쓸 수 없다.

## 2.5 디스크의 종류
- SATA 하드디스크
  - SAS 하드디스크보다 저렴하고 중요하지 않은 서버에서는 일부러 내장애성을 희생하고 SATA 하드디스크를 채용
- SAS 하드디스크
  - 고속으로 동작
  - 24시간, 365일 가동할 용도로 사용
- FC 하드디스크
  - 초고속으로 동작하고 신뢰성이 높음
  - SAN 스토리지 등 엔터프라이즈 용도로 사용
- SSD
  - 반도체 소자 메모리를 기억 장치에 이용한 디스크
  - 매우 비쌈
  - 쓰기와 지우기를 반복하면 소자가 열화되어 성능이 떨어진다
  - SLC : 기억 소자 하나에 1bit 데이터를 기록. 쓰기 속도가 빠름. 다시 쓰기 가능 횟수 많음.
  - MLC : 기억 소자 하나에 2bit 데이터를 기록. 쓰기 속도 느림. 다시 쓰기 가능 횟수 적음.
  
## 2.6 RAID
RAID는 성능과 내장애성을 높이기 위한 목적으로 이용

- RAID 레벨

| RAID | 설명 | 용도 | 
|:-----:|:------:|:-------:|
| 0 | 내장애성이 없는 디스크 어레이 | 디스크 I/O 성능을 높여야 할 때 사용 |
| 1 | 이중화 | 내장애성이 높음. 운영체제가 설치된 파티션 등에 사용 |
| 5 | 블록 단위 패리티 정보 기록 | 저장 용량을 넉넉하게 확보하고자 할 때 사용 | 
| 6 | 블록 단위에서 두 가지 패리티 정보 기록 | RAID5와 용도 같지만 보다 내장애성이 높음 |
| 10 | RAID1을 스트라이핑한 것 | 내장애성과 디스크 I/O 성능을 모두 만족(데이터베이스) |
| 50 | RAID5를 스트라이핑한 것 | 저장 용량 확보와 디스크 I/O 성능을 모두 만족(파일 서버, 로그 저장) |
| 60 | RAID6을 스트라이핑한 것 | 저장 용량 확보와 디스크 I/O 성능을 모두 만족(파일 서버, 로그 저장) |

- RAID 성능
RAID를 구성하면 디스크 I/O 성능을 높일 수 있다. <br>
IOPS : 1초당 처리할 수 있는 I/O 수치

## 2.7 가상화
가상화 기술을 사용하면, 한 대의 물리 서버에서도 여러 개의 게스트 운영체제를 가동할 수 있다. (서버 가상화)<br>
가상화 환경에서는 물리 서버가 제공하는 하드웨어 자원을 게스트 운영체제에 자유롭게 할당

- 물리 서버
  - CPU 사용률, 디스크 I/O 부하, 디스크 사용 용량이 많은 용도에 적합
  - 데이터베이스 서버, 애플리케이션 서버 적합
  
- 가상 서버
  - CPU 사용률,  디스크 I/O 부하, 디스크 사용 용량이 적은 용도에 적합
  - 웹 서버, 개발 서버, 메모리 DB 적합
  
- 물리 서버를 가상화할 때의 장/단점
  - 장점
    - 비용을 줄일 수 있다
    - 게스트 운영체제의 하드웨어 자원을 쉽게 늘리거나 줄일 수 있다
    - 하드웨어 노후 걱정이 없다
  - 단점
    - 다른 게스트 운영체제가 하드웨어 자원을 많이 사용하면, 다른 게스트 운영체제의 동작이 불안정해진다
    - 사용하지 않는 서버가 없어지지 않고 남기 쉽다
    
- 가상화 모델
  - 호스트 운영체제 타입
    - 일반 운영체제에 게스트 운영체제를 관리하는 프로그램을 설치해서 가상화하는 방식
    - 가상화 환경을 다룰 수 있어 손쉽게 구현
    - 동작에 오버헤드 발생
  - 하이퍼바이저 타입
    - 호스트 운영체제 대신 가상화 전용 운영체제를 사용하는 방식
    - 서버 용도로 사용할 때 주로 채용
    
## 2.8 클라우드 : IaaS
Saas : 애플리케이션을 서비스로서 제공<br>
Paas : 애플리케이션 실행 환경을 서비스로서 제공<br>
Iaas : 시스템 인프라를 서비스로서 제공

- Iaas 특징
  - 사내에 물리 서버를 두지 않아도 사용할 수 있으므로, 물리 서버를 관리하는 엔지니어가 필요 없다
  - 단기간에 운영체제가 설치된 상태로 바로 사용 가능
  - 이용하고 싶은 만큼 서버 증강 가능
  - 사용한 만큼 비용 발생

- 클라우드에 맞지 않는 용도
  - 기밀 정보 저장
  - 대용량 파일 전송
  - 대규모 시스템
